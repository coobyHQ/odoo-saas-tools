<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- client instance -->
    <record id="view_clients_helpdesk_form" model="ir.ui.view">
        <field name="name">saas_portal.client.helpdesk.form</field>
        <field name="model">saas_portal.client</field>
        <field name="inherit_id" ref="saas_portal.view_clients_form"/>
        <field name="arch" type="xml"><!-- Todo fix xpath
            <xpath expr="//div[@button='saas_portal.sync_client']" position="after">
            <button name="%(saas_plan_change_wizard_action)d" string="Change Plan" type="action"/>
            </xpath>-->

                <xpath expr="//div[@name='button_box']" position="inside">
                    <button class="oe_inline oe_stat_button" type="action" name="%(website_support.website_support_ticket_action_partner)d"
                            context="{'search_default_client_id': saas_client_id}"
                            icon="fa-ticket">
                        <field name="support_ticket_string" string="Support Tickets" widget="statinfo"/>
                    </button>

                </xpath>
                <!-- <notebook position="inside"> -->
                <xpath expr="//page[@name='service_policy']" position="after">
                    <page string="Assigned Support Tickets" name="assigned_support_ticket_page">
                        <group>
                            <label for="assigned_support_ticket_ids"/>
                            <field name="assigned_support_ticket_ids" nolabel="1"/>
                        </group>
                    </page>
                </xpath>
        </field>
    </record>

    <record id="website_support_ticket_view_search_user" model="ir.ui.view">
        <field name="name">website.support.ticket.form.user.search</field>
        <field name="model">website.support.ticket</field>
        <field name="arch" type="xml">
            <search>
                <field name="user_partner_id"/>
                <filter string="Unattended Tickets" name="unattended_tickets" domain="[('unattended', '=', True )]" />
                <filter name="group_by_category" string="Category" domain="[]"  context="{'group_by':'category'}"/>
                <filter name="group_by_user" string="User" domain="[]"  context="{'group_by':'user_id'}"/>
            </search>
        </field>
    </record>

    <record id="website_support_ticket_action_user" model="ir.actions.act_window">
        <field name="name">Assigned Support Tickets</field>
        <field name="res_model">website.support.ticket</field>
        <field name="view_mode">tree,form,graph</field>
        <field name="help" type="html">
            <p>
                No assigned Support Tickets found
            </p>
        </field>
    </record>

</odoo>