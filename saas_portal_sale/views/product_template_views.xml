<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="product_template_saas" model="ir.ui.view">
    <field name="name">product.product.saas</field>
    <field name="model">product.template</field>
    <field name="inherit_id" ref="product.product_template_only_form_view"/>
    <field name="arch" type="xml">

      <xpath expr="//field[@name='purchase_ok']" position="before">
        <field name="is_saas"/>
        <label for="is_saas"/>
      </xpath>

      <xpath expr="//page[last()]" position="after">
        <page string="SaaS" name="saas" attrs="{'invisible': [('is_saas','=',False)]}">
          <group>
            <field name="saas_product_type"
                   attrs="{'required': [('is_saas','=',True)], 'invisible': [('is_saas','=',False)]}"/>
            <field name="saas_base_type"
                   attrs="{'required': [('saas_product_type','=','base')], 'invisible': [('saas_product_type','=','topup')]}"/>
            <field name="saas_topup_type"
                   attrs="{'required': [('saas_product_type','=','topup')], 'invisible': [('saas_product_type','=','base')]}"/>

            <field name="saas_plan_id"/>
            <field name="saas_default"/>
            <field name="trial_allowed"/>
            <field name="plan_ids"/>
          </group>
        </page>
      </xpath>
    </field>
  </record>


  <record id="product_product_saas" model="ir.ui.view">
    <field name="name">product.product.saas</field>
    <field name="model">product.product</field>
    <field name="inherit_id" ref="product.product_normal_form_view"/>
    <field name="arch" type="xml">
      <xpath expr="//page[last()]" position="after">
        <page string="SaaS" name="saas" attrs="{'invisible': [('is_saas','=',False)]}">
          <group>
            <field name="is_saas"/>
            <field name="saas_product_type"/>
            <field name="saas_plan_id"/>
            <field name="saas_default"/>
          </group>
        </page>
      </xpath>
    </field>
  </record>
</odoo>
